var max_progress=0;const observer=lozad(".lozad",{"loaded":function(){if($("progress.progress").length){winHeight=$(window).height(),docHeight=$(".medir-contenido").height();max_progress=docHeight-winHeight;$("progress.progress").attr("max",max_progress)}}});observer.observe();var idx=lunr(function(){this.use(lunr.multiLanguage("es","en"));this.ref("id");this.field("titulo",{"boost":10});this.field("url");this.field("contenido");for(var key in busqueda_idx){this.add({"id":key,"titulo":busqueda_idx[key].titulo,"url":busqueda_idx[key].url,"contenido":busqueda_idx[key].contenido})}});function slug(slug_t,espacio=false){var opciones={"remove":/[\/\\\[\]{}()*+~.'"!\xa1?\xbf:@]/g,"lower":true,"strict":true,"locale":"es","trim":true};var opciones2={"replacement":" ","remove":/[\[\]{}()*+~.'"!\xa1?\xbf:@]/g,"lower":true,"locale":"es","trim":true};if(espacio){return slugify(slug_t,opciones2)}else{return slugify(slug_t,opciones)}}function resaltar_palabras(palabras,texto){var pal_jun=palabras.join("|");var pal_jun_regx=pal_jun.replace(/[aeiou]/gi,"\\p{Script_Extensions=Latin}");var texto2="";var regex=new RegExp(pal_jun_regx,"giu");texto2=texto.replace(regex,function(coincidencia){return"<mark>"+coincidencia+"</mark>"});return texto2}function buscar_sitio(){if($("#resultados_b")){$("#buscar_b").addClass("is-loading");var resultados=idx.search($("#buscar_t").val());if(resultados.length>0){var terminos_busqueda=slug($("#buscar_t").val()).split("-");var paginas_resultados=resultados.map(function(match){return busqueda_idx[match.ref]});var resultados_html="";paginas_resultados.forEach(function(r){resultados_html+='<article class="media is-borderless">';resultados_html+='<div class="media-content">';resultados_html+='<div class="content">';resultados_html+='<h4 class="title is-4"><a class="has-text-dark" href="'+r.url+'">'+resaltar_palabras(terminos_busqueda,r.titulo)+"</a></h4>";resultados_html+='<p class="subtitle is-6">'+fechas_subtitulo(r.fecha_publicada)+"</p>";resultados_html+='<p class="content">';resultados_html+=resaltar_palabras(terminos_busqueda,r.excerpt);resultados_html+="</p>";resultados_html+="</div>";resultados_html+='<nav class="level is-mobile">';resultados_html+='<div class="level-left">';resultados_html+='<div class="level-item">';resultados_html+='<div class="tags">';r.etiquetas.forEach(function(e){resultados_html+='<span class="tag is-link is-normal"><a class="has-text-white "href="/etiqueta/'+slug(e)+'">'+e+"</a></span>"});resultados_html+="</div>";resultados_html+="</div>";resultados_html+="</div>";resultados_html+="</nav>";resultados_html+="</div>";resultados_html+="</article>"});if($("#resultados_c").hasClass("is-hidden")){$("#resultados_c").removeClass("is-hidden");$("#resultados_b").empty();$("#resultados_b").html(resultados_html)}else{$("#resultados_b").empty();$("#resultados_b").html(resultados_html)}$("#buscar_b").removeClass("is-loading")}else{if($("#resultados_c").hasClass("is-hidden")){$("#resultados_b").empty();$("#resultados_c").removeClass("is-hidden");$("#resultados_b").html('<h4 class="title is-4">No se encontraron resultados.</h4>')}else{$("#resultados_b").empty();$("#resultados_b").html('<h4 class="title is-4">No se encontraron resultados.</h4>')}$("#buscar_b").removeClass("is-loading")}}}function fechas_subtitulo(fecha_texto){var fecha=new Date(fecha_texto);var mes=fecha.toLocaleString("es",{"month":"long"});var dia=fecha.getDate();var anio=fecha.getFullYear();return dia+" de "+mes+", "+anio}function revisar_klaro(){if(document.cookie.split(";").some(item=>item.trim().startsWith("klaro_lewatoto="))){return true}else{return false}}function mostrar_ir_inicio_post(){var observer=new IntersectionObserver(function(entries){if(entries[0].intersectionRatio===0){if($(".subir").is(".is-hidden")){$(".subir").toggleClass("is-hidden")}if($("progress.progress").is(".is-hidden")){$("progress.progress").toggleClass("is-hidden")}}else if(entries[0].intersectionRatio===1){if(!$(".subir").is(".is-hidden")){$(".subir").toggleClass("is-hidden")}if(!$("progress.progress").is(".is-hidden")){$("progress.progress").toggleClass("is-hidden")}}},{"threshold":[0,1]});observer.observe(document.querySelector(".mostrar_ir_inicio_post"))}function ir_a_inicio(){var observer=new IntersectionObserver(function(entries){if(entries[0].intersectionRatio===0){if($(".subir").is(".is-hidden")){$(".subir").toggleClass("is-hidden")}}else if(entries[0].intersectionRatio===1){if(!$(".subir").is(".is-hidden")){$(".subir").toggleClass("is-hidden")}}},{"threshold":[0,1]});observer.observe(document.querySelector(".ir_a_inicio"))}function pin_indice(){$("aside.indice").toggleClass("indice_pin")}function subir(){$("html").animate({"scrollTop":"0"},200,function(){})}$(document).ready(function(){$(".navbar-burger").click(function(){$(".navbar-burger").toggleClass("is-active");$(".navbar-menu").toggleClass("is-active")});$(".buttons > a").click(function(){$(".navbar-burger").toggleClass("is-active");$(".navbar-menu").toggleClass("is-active")});$("#buscar_b").click(function(){buscar_sitio()});$(".delete").click(function(){$("#resultados_b").empty();$(".delete").parents(":eq(2)").addClass("is-hidden")});$("#buscar_t").bind("enterKey",function(e){buscar_sitio()});$("#buscar_t").keyup(function(e){if(e.keyCode==13){$(this).trigger("enterKey")}});$(".mostrar_comentarios").click(function(){$(this).toggleClass("is-hidden");$("#disqus_thread").toggleClass("is-hidden")});$("#activar_disqus").click(function(){klaro.show();$(".activar_disqus").toggleClass("is-hidden");$("#disqus_thread").toggleClass("is-hidden")});$(".subir").click(function(){subir()});if($(".indice").length){mostrar_ir_inicio_post();var spy=new Gumshoe("#toc_menu a",{"navClass":"is-active","contentClass":"active","nested":false,"nestedClass":"is-active","offset":80,"reflow":true,"events":true})}else{ir_a_inicio()}var winHeight=$(window).height();var docHeight=$(".medir-contenido").height();max_progress=docHeight-winHeight;$("progress.progress").attr("max",max_progress);$(document).on("scroll",function(){value=$(window).scrollTop();if(value>max_progress){if(!$("progress.progress").is(".is-hidden")){$("progress.progress").toggleClass("is-hidden")}}else{if($("progress.progress").is(".is-hidden")&&!$(".subir").is(".is-hidden")){$("progress.progress").toggleClass("is-hidden")}$("progress.progress").attr("value",value)}});$(window).on("resize",function(){winHeight=$(window).height(),docHeight=$(".medir-contenido").height();max_progress=docHeight-winHeight;$("progress.progress").attr("max",max_progress);value=$(window).scrollTop();$("progress.progress").attr("value",value)});document.addEventListener("gumshoeActivate",function(event){if($("aside.indice").hasClass("indice_pin")&&$("details")[0].open){$(".indice_pin details[open] > div.menu").animate({"scrollTop":$("li.is-active").get(0).offsetTop-$(".indice_pin details[open] > div.menu").get(0).offsetTop-10+"px"},200)}},false);$(".fa-thumbtack").click(function(e){e.stopImmediatePropagation();$(this).toggleClass("activado");pin_indice();winHeight=$(window).height(),docHeight=$(".medir-contenido").height();max_progress=docHeight-winHeight;$("progress.progress").attr("max",max_progress)})});